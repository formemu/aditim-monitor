# ADITIM Monitor

Клиент-серверная система управления задачами в цехе металлообработки.

## Описание

ADITIM Monitor предназначен для отслеживания и управления производственными задачами по изготовлению инструментов (профилей) и других изделий. Система состоит из сервера на FastAPI и клиентского приложения на PySide6.

## Возможности

### Сервер (FastAPI + SQLite)
- REST API для управления задачами
- База данных SQLite с моделями задач, продуктов, профилей
- Поддержка drag-drop изменения приоритетов задач
- CORS для подключения клиентов

### Клиент (PySide6)
- Просмотр активных задач с фильтрацией
- Автоматическое обновление каждые 5 секунд
- Drag-drop для изменения приоритетов
- Отдельные диалоги для создания/редактирования задач

## Типы задач

1. **Инструмент на экструзию (профили)**:
   - Фиксированный набор оборудования: плиты 1-4, пальцы, усреднитель, кондуктор
   - Типы работ: новый инструмент, новый вариант, доработка и т.д.

2. **Другие задачи**:
   - Произвольное оборудование
   - Настраиваемые компоненты

## Установка

### Требования
- Python 3.8+
- pip

### Быстрая установка
```bash
python setup.py
```

### Ручная установка зависимостей
```bash
pip install -r requirements.txt
```

### Проверка установки
После установки зависимостей ошибки импорта в IDE должны исчезнуть.

## Запуск

### Быстрый запуск (рекомендуется)
```bash
# Сервер
python run_server.py

# Клиент (в отдельном терминале)
python run_client.py
```

### Альтернативный запуск
```bash
# Сервер
cd src/server
python main.py

# Клиент  
cd src/client
python main.py
```

## Структура проекта

```
src/
├── server/                  # FastAPI сервер
│   ├── main.py             # Точка входа сервера
│   ├── database.py         # Настройка базы данных
│   ├── models/             # SQLAlchemy модели
│   ├── api/                # API маршруты
│   └── schemas/            # Pydantic схемы
├── client/                 # PySide6 клиент
│   ├── main.py             # Точка входа клиента
│   ├── main_window.py      # Главное окно
│   ├── api_client.py       # HTTP клиент
│   ├── constants.py        # Константы
│   ├── ui/                 # UI файлы
│   ├── widgets/            # Пользовательские виджеты
│   └── resources/          # Ресурсы (стили, иконки)
└── shared/                 # Общие утилиты
```

## API Документация

После запуска сервера документация доступна по адресу:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### Основные эндпоинты

- `GET /api//tasks/` - Получить задачи с фильтрацией
- `POST /api/tasks/` - Создать задачу
- `PUT /api/tasks/{id}` - Обновить задачу
- `PUT /api/tasks/{id}/position` - Изменить позицию задачи
- `GET /api/directories/statuses/` - Получить статусы
- `GET /api/directories/departments/` - Получить департаменты

## Разработка

### Стиль кода
- Используется black, flake8, mypy
- Соблюдение принципов SOLID, DRY, KISS
- Type hints для всех функций

### Тестирование
```bash
pytest tests/ -v
```

### Линтеры
```bash
black src/
flake8 src/
mypy src/
```

## База данных

SQLite база данных создается автоматически при первом запуске сервера.

Основные таблицы:
- `tasks` - Задачи
- `product` - Продукты
- `profile` - Профили
- `dir_*` - Справочные таблицы

## Лицензия

Внутренний проект компании.
